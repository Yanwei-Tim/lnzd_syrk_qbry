<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
				"http://ibatis.apache.org/dtd/sql-map-2.dtd">


<!-- 不使用namespace的话sql搜索定位会比较方便 -->
<sqlMap namespace="ZdryXdrynjxxb">

    <typeAlias alias="zdryXdrynjxxb" type="com.founder.zdrygl.bean.ZdryXdrynjxxb" />
	
	<!-- 用于select查询公用抽取的列 -->
	<sql id="columns">
	    <![CDATA[
		ID,ZDRYID,NJ_RQ,NJJGDM,QD_RQ,BZ,XT_CJSJ,XT_LRSJ,XT_LRRXM,XT_LRRID,XT_LRRBM,XT_LRRBMID,XT_LRIP,XT_ZHXGSJ,XT_ZHXGRXM,XT_ZHXGRID,XT_ZHXGRBM,XT_ZHXGRBMID,XT_ZHXGIP,XT_ZXBZ,XT_ZXYY
	    ]]>
	</sql>

    <sql id="insertColumns">
		     <isNotEmpty  property="id">ID</isNotEmpty>
		    <isNotEmpty prepend="," property="zdryid">ZDRYID</isNotEmpty>
		    <isNotEmpty prepend="," property="nj_rq">NJ_RQ</isNotEmpty>
		    <isNotEmpty prepend="," property="njjgdm">NJJGDM</isNotEmpty>
		    <isNotEmpty prepend="," property="qd_rq">QD_RQ</isNotEmpty>
		    <isNotEmpty prepend="," property="bz">BZ</isNotEmpty>
		    ,
			<include refid="insertXtzd"/>
	</sql>

	<sql id="insertColumnsValues">
			<isNotEmpty  property="id">#id#</isNotEmpty>
			<isNotEmpty prepend="," property="zdryid">#zdryid#</isNotEmpty>
			<isNotEmpty prepend="," property="nj_rq">#nj_rq#</isNotEmpty>
			<isNotEmpty prepend="," property="njjgdm">#njjgdm#</isNotEmpty>
			<isNotEmpty prepend="," property="qd_rq">#qd_rq#</isNotEmpty>
			<isNotEmpty prepend="," property="bz">#bz#</isNotEmpty>
			,
			<include refid="insertXtzdVal"/>
	</sql>

		<!-- useGeneratedKeys="true" keyProperty="xxx" for sqlserver and mysql -->
	<insert id="insert" >
		INSERT INTO ZDRY_XDRYNJXXB (
		<include refid="insertColumns"/>
		) VALUES (
		<include refid="insertColumnsValues"/>
		)
	</insert>

	<sql id="updateColumns">
		<dynamic prepend="set">
	       <isNotNull prepend="," property="zdryid">ZDRYID = #zdryid#</isNotNull>
	       <isNotNull prepend="," property="nj_rq">NJ_RQ = #nj_rq#</isNotNull>
	       <isNotNull prepend="," property="njjgdm">NJJGDM = #njjgdm#</isNotNull>
	       <isNotNull prepend="," property="qd_rq">QD_RQ = #qd_rq#</isNotNull>
	       <isNotNull prepend="," property="bz">BZ = #bz#</isNotNull>
			,
			<include refid="updateXtzd"/>
		</dynamic>
	</sql>

	<update id="update" >
		UPDATE ZDRY_XDRYNJXXB
		<include refid="updateColumns"/>
		WHERE
		ID = #id# 
	</update>

		<!-- 注销 -->
    <update id="delete" parameterClass="zdryXdrynjxxb">
       <![CDATA[ update ZDRY_XDRYNJXXB set ]]><include refid="deleteXtzd"/><![CDATA[ where ID = #id# ]]>
    </update>
    
    <select id="queryById" resultClass="zdryXdrynjxxb">
		SELECT <include refid="columns" />
	    <![CDATA[
		    FROM ZDRY_XDRYNJXXB 
	        WHERE 
		        ID = #id# 
	    ]]>
	</select>
	
	<sql id="queryWhere">
		<!-- ognl访问静态方法的表达式 为@class@method(args),以下为调用rapid中的Ognl.isNotEmpty()方法,还有其它方法如isNotBlank()可以使用，具体请查看Ognl类 -->
		<dynamic prepend="where">
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.id">
				AND ID = #zdryXdrynjxxbVO.id#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.zdryid">
				AND ZDRYID = #zdryXdrynjxxbVO.zdryid#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.nj_rq">
				AND NJ_RQ = #zdryXdrynjxxbVO.nj_rq#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.njjgdm">
				AND NJJGDM = #zdryXdrynjxxbVO.njjgdm#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.qd_rq">
				AND QD_RQ = #zdryXdrynjxxbVO.qd_rq#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.bz">
				AND BZ = #zdryXdrynjxxbVO.bz#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_cjsj">
				AND XT_CJSJ = #zdryXdrynjxxbVO.xt_cjsj#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_lrsj">
				AND XT_LRSJ = #zdryXdrynjxxbVO.xt_lrsj#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_lrrxm">
				AND XT_LRRXM = #zdryXdrynjxxbVO.xt_lrrxm#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_lrrid">
				AND XT_LRRID = #zdryXdrynjxxbVO.xt_lrrid#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_lrrbm">
				AND XT_LRRBM = #zdryXdrynjxxbVO.xt_lrrbm#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_lrrbmid">
				AND XT_LRRBMID = #zdryXdrynjxxbVO.xt_lrrbmid#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_lrip">
				AND XT_LRIP = #zdryXdrynjxxbVO.xt_lrip#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zhxgsj">
				AND XT_ZHXGSJ = #zdryXdrynjxxbVO.xt_zhxgsj#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zhxgrxm">
				AND XT_ZHXGRXM = #zdryXdrynjxxbVO.xt_zhxgrxm#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zhxgrid">
				AND XT_ZHXGRID = #zdryXdrynjxxbVO.xt_zhxgrid#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zhxgrbm">
				AND XT_ZHXGRBM = #zdryXdrynjxxbVO.xt_zhxgrbm#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zhxgrbmid">
				AND XT_ZHXGRBMID = #zdryXdrynjxxbVO.xt_zhxgrbmid#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zhxgip">
				AND XT_ZHXGIP = #zdryXdrynjxxbVO.xt_zhxgip#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zxbz">
				AND XT_ZXBZ = #zdryXdrynjxxbVO.xt_zxbz#
			</isNotEmpty>
	       <isNotEmpty prepend="and" property="zdryXdrynjxxbVO.xt_zxyy">
				AND XT_ZXYY = #zdryXdrynjxxbVO.xt_zxyy#
			</isNotEmpty>
		</dynamic>
	</sql>
		
    <select id="queryCount" resultClass="Integer">
        SELECT count(*) FROM ZDRY_XDRYNJXXB 
		<include refid="queryWhere"/>
    </select>
    
    <!--
    	分页查询已经使用Dialect进行分页,也可以不使用Dialect直接编写分页
    	因为分页查询将传 offset,pageSize,lastRows 三个参数,不同的数据库可以根于此三个参数属性应用不同的分页实现
    -->
    <select id="query" resultClass="zdryXdrynjxxb">
    	SELECT <include refid="columns" />
	    FROM ZDRY_XDRYNJXXB 
		<include refid="queryWhere"/>
		
		<isNotEmpty prepend="and" property="page.sort">
			ORDER BY '$sort$'
		</isNotEmpty>
    </select>

	<!-- 查询显示列表 -->
	<select id="queryViewList" parameterClass="Map" resultClass="zdryXdrynjxxb">
		<![CDATA[ select * from (
			select * from ZDRY_XDRYNJXXB t where t.XT_ZXBZ = '0' and zdryid = #zdryid# ]]>
		<![CDATA[ order by xt_cjsj desc) m where rownum <= #maxNum# ]]>
	</select>
</sqlMap>

