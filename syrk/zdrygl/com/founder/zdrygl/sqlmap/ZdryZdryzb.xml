<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ZdryZdryzb">
	
	<typeAlias alias="zdryZdryzb" type="com.founder.zdrygl.bean.ZdryZdryzb" />
	<typeAlias alias="zdryZdryzbVO" type="com.founder.zdrygl.vo.ZdryZdryzbVO" />
	<typeAlias alias="zdrylgxxVO" type="com.founder.zdrygl.vo.ZdrylgxxVO" />
	<!-- 查询人员所有类型列表 -->
	<select id="queryList" parameterClass="String" resultClass="zdryZdryzb">
		<![CDATA[  select * from ZDRY_ZDRYZB t where  ryid = #ryid#  and glzt in (1,2,3,5,7)  and  t.XT_ZXBZ = '0']]>
	</select>
	
	<!-- 根据身份证查询重口类型 -->
	<select id="queryZdrylxdmByGmsfhm" parameterClass="String"
		resultClass="zdryZdryzb">
		 select * from ZDRY_ZDRYZB t where  glzt in (1,2,3,5,7) and zdrygllxdm='7'  and  t.XT_ZXBZ = '0' and ZJHM= #zjhm# and 	CYZJDM='111'
	</select>

	<!-- 查询单条（根据主键） -->
	<select id="queryById" parameterClass="String" resultClass="zdryZdryzb">
		<![CDATA[ select * from ZDRY_ZDRYZB t where ID = #id#  and rownum = 1  ]]>
	</select>
	
	<select id="queryZdryBySyrkid" parameterClass="String" resultClass="zdryZdryzb">
		<![CDATA[ select t.* from ZDRY_ZDRYZB t 
  			 where  t.syrkid = #id# and t.glzt in (1,2,3,5,7)  and t.XT_ZXBZ = '0'  ]]>
	</select>
	
	<select id="queryLgxxByZdryid" parameterClass="String" resultClass="zdrylgxxVO">
		<![CDATA[ 
		   			select t.* from ZDRY_ZDRYZB t 
  			           where  t.id = #zdryid# and t.glzt in (1,2,3,5,7)  and t.XT_ZXBZ = '0'  		
			]]>		
	</select>

	<select id="queryZdryVOByRyid" parameterClass="Map" resultClass="zdryZdryzbVO">
		<![CDATA[ 
			select rownum r ,m.*,L.BZ as zdrygllxmc,L.FZ,g.jgbmdm ,g.jgbmmc,g.sfsjsp 
			from (
				select z.*,r.CYZJDM,r.ZJHM,r.XM,r.XBDM,r.MZDM,r.CSRQ,r.Jzd_dzxz as dz_jzdzxz,b.zbx , b.zby 
				from ZDRY_ZDRYZB z,RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b 
				where z.ryid = #ryid# 
					and  (b.mldzid=r.Jzd_mlpdm or (r.Hjd_mlpdm = b.mldzid and  r.Jzd_mlpdm is null)) 
					and r.ID=z.RYID and z.glzt in (1,2,3,4,5,6,7)  and  z.XT_ZXBZ = '0' and b.xt_zxbz='0'

			) m  
			left join  ZDRY_ZDRYLXYLBDYB L on (L.LBDM=m.ZDRYGLLXDM and L.QYDM=#QYDM#)  
			left join ZDRY_GLPZPZB g on (m.zdrygllxdm = g.zdrygllxdm and g.xt_zxbz = '0')							
			]]>		
	</select>
	<select id="queryZdryVOByZdryid" parameterClass="Map" resultClass="zdryZdryzbVO">
		<![CDATA[ 
			select rownum r ,m.*,L.BZ as zdrygllxmc,L.FZ,g.jgbmdm ,g.jgbmmc,g.sfsjsp 
			from (
				select z.*,r.CYZJDM,r.ZJHM,r.XM,r.XBDM,r.MZDM,r.CSRQ,r.Jzd_dzxz as dz_jzdzxz,b.zbx , b.zby 
				from ZDRY_ZDRYZB z,RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b 
				where z.id = #zdryid# 
					and  (b.mldzid=r.Jzd_mlpdm or (r.Hjd_mlpdm = b.mldzid and  r.Jzd_mlpdm is null)) 
					and r.ID=z.RYID and z.glzt in (1,2,3,5,7)  and  z.XT_ZXBZ = '0' and b.xt_zxbz='0'

			) m  
			left join  ZDRY_ZDRYLXYLBDYB L on (L.LBDM=m.ZDRYGLLXDM and L.QYDM=#QYDM#)  
			left join ZDRY_GLPZPZB g on (m.zdrygllxdm = g.zdrygllxdm and g.xt_zxbz = '0')									
			]]>		
	</select>

	<select id="querySgafZdryVOByRyid" parameterClass="Map" resultClass="zdryZdryzbVO">
		<![CDATA[ select rownum r ,m.*,L.BZ as zdrygllxmc，g.jgbmdm ,g.jgbmmc,g.sfsjsp 
		from (
			select z.*,r.CYZJDM,sga.gmsfhm,sga.XM,sga.XBDM,r.MZDM,r.CSRQ,r.Jzd_dzxz as dz_jzdzxz,b.zbx , b.zby 
			from ZDRY_ZDRYZB z,RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b ,ZDRY_SGAFZDRYXXB sga
			where z.ryid = #ryid#  and z.ryid=r.id and z.id=sga.id
			and  (b.mldzid=sga.Jzd_mlpdm or (r.Hjd_mlpdm = b.mldzid and  sga.Jzd_mlpdm is null)) 
			and  z.glzt in ('2','6')  and  z.XT_ZXBZ = '0' and b.xt_zxbz='0') m  
			left join  ZDRY_ZDRYLXYLBDYB L on (L.LBDM=m.ZDRYGLLXDM and L.QYDM=#QYDM#)  
			left join  ZDRY_GLPZPZB g on (m.zdrygllxdm = g.zdrygllxdm and g.xt_zxbz = '0')						
			]]>		
	</select>



	<!-- 新增 -->
	<insert id="save" parameterClass="zdryZdryzb">
		<![CDATA[ insert into ZDRY_ZDRYZB (ID]]>		
		<isNotEmpty prepend="," property="ryid"><![CDATA[ ryid]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdrylb"><![CDATA[ zdrylb]]></isNotEmpty>
		<isNotEmpty prepend="," property="syrkid"><![CDATA[ syrkid]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdrygllxdm"><![CDATA[ zdrygllxdm]]></isNotEmpty>
		<isNotEmpty prepend="," property="glzt"><![CDATA[ glzt]]></isNotEmpty>
		<isNotEmpty prepend="," property="zywtjxsbx"><![CDATA[ zywtjxsbx]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdlgbmid"><![CDATA[ zdlgbmid]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdlgbmmc"><![CDATA[ zdlgbmmc]]></isNotEmpty>
		<isNotEmpty prepend="," property="sfjm"><![CDATA[ sfjm]]></isNotEmpty>
		<isNotEmpty prepend="," property="sfzkdm"><![CDATA[ sfzkdm]]></isNotEmpty>
		<isNotEmpty prepend="," property="glbm"><![CDATA[ glbm]]></isNotEmpty>
		<isNotEmpty prepend="," property="cxbm"><![CDATA[ cxbm]]></isNotEmpty>		
		<isNotEmpty prepend="," property="jgssxdm"><![CDATA[ jgssxdm]]></isNotEmpty>
		<isNotEmpty prepend="," property="hjd_ssxjgajgdm"><![CDATA[ hjd_ssxjgajgdm]]></isNotEmpty>
		<isNotEmpty prepend="," property="hjd_sspcsdm"><![CDATA[ hjd_sspcsdm]]></isNotEmpty>
		<isNotEmpty prepend="," property="hjd_sssq"><![CDATA[ hjd_sssq]]></isNotEmpty>
		<isNotEmpty prepend="," property="jzd_szdsdm"><![CDATA[ jzd_szdsdm]]></isNotEmpty>
		<isNotEmpty prepend="," property="gxbm"><![CDATA[ gxbm]]></isNotEmpty>
		,
		<include refid="insertXtzd"/>)
		<![CDATA[ values (#id# ]]>		
		<isNotEmpty prepend="," property="ryid"><![CDATA[#ryid#]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdrylb"><![CDATA[#zdrylb#]]></isNotEmpty>
		<isNotEmpty prepend="," property="syrkid"><![CDATA[#syrkid#]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdrygllxdm"><![CDATA[#zdrygllxdm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="glzt"><![CDATA[#glzt#]]></isNotEmpty>
		<isNotEmpty prepend="," property="zywtjxsbx"><![CDATA[#zywtjxsbx#]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdlgbmid"><![CDATA[#zdlgbmid#]]></isNotEmpty>
		<isNotEmpty prepend="," property="zdlgbmmc"><![CDATA[#zdlgbmmc#]]></isNotEmpty>
		<isNotEmpty prepend="," property="sfjm"><![CDATA[#sfjm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="sfzkdm"><![CDATA[#sfzkdm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="glbm"><![CDATA[#glbm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="cxbm"><![CDATA[#cxbm#]]></isNotEmpty>		
		<isNotEmpty prepend="," property="jgssxdm"><![CDATA[#jgssxdm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="hjd_ssxjgajgdm"><![CDATA[#hjd_ssxjgajgdm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="hjd_sspcsdm"><![CDATA[#hjd_sspcsdm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="hjd_sssq"><![CDATA[#hjd_sssq#]]></isNotEmpty>
		<isNotEmpty prepend="," property="jzd_szdsdm"><![CDATA[#jzd_szdsdm#]]></isNotEmpty>
		<isNotEmpty prepend="," property="gxbm"><![CDATA[#gxbm#]]></isNotEmpty>

		,
		<include refid="insertXtzdVal"/>)
	</insert>
	
	<!-- 更新 -->
	<update id="update" parameterClass="zdryZdryzb">
		<![CDATA[ update ZDRY_ZDRYZB ]]>	
		<dynamic prepend="set">			
			<isNotNull prepend="," property="ryid"><![CDATA[ ryid = #ryid#]]></isNotNull>
			<isNotNull prepend="," property="zdrylb"><![CDATA[ zdrylb = #zdrylb#]]></isNotNull>
			<isNotNull prepend="," property="syrkid"><![CDATA[ syrkid = #syrkid#]]></isNotNull>
			<isNotNull prepend="," property="zdrygllxdm"><![CDATA[ zdrygllxdm = #zdrygllxdm#]]></isNotNull>
			<isNotNull prepend="," property="glzt"><![CDATA[ glzt = #glzt#]]></isNotNull>
			<isNotNull prepend="," property="zywtjxsbx"><![CDATA[ zywtjxsbx = #zywtjxsbx#]]></isNotNull>
			<isNotNull prepend="," property="zdlgbmid"><![CDATA[ zdlgbmid = #zdlgbmid#]]></isNotNull>
			<isNotNull prepend="," property="zdlgbmmc"><![CDATA[ zdlgbmmc = #zdlgbmmc#]]></isNotNull>
			<isNotNull prepend="," property="sfjm"><![CDATA[ sfjm = #sfjm#]]></isNotNull>
			<isNotNull prepend="," property="sfzkdm"><![CDATA[ sfzkdm = #sfzkdm#]]></isNotNull>
			<isNotNull prepend="," property="glbm"><![CDATA[ glbm = #glbm#]]></isNotNull>
			<isNotNull prepend="," property="gxbm"><![CDATA[ gxbm = #gxbm#]]></isNotNull>			
			<isNotNull prepend="," property="cxbm"><![CDATA[ cxbm = #cxbm#]]></isNotNull>			
			<isNotNull prepend="," property="jgssxdm"><![CDATA[ jgssxdm = #jgssxdm#]]></isNotNull>
			<isNotNull prepend="," property="hjd_ssxjgajgdm"><![CDATA[ hjd_ssxjgajgdm = #hjd_ssxjgajgdm#]]></isNotNull>
			<isNotNull prepend="," property="hjd_sspcsdm"><![CDATA[ hjd_sspcsdm = #hjd_sspcsdm#]]></isNotNull>
			<isNotNull prepend="," property="hjd_sssq"><![CDATA[ hjd_sssq = #hjd_sssq#]]></isNotNull>
			<isNotNull prepend="," property="jzd_szdsdm"><![CDATA[ jzd_szdsdm = #jzd_szdsdm#]]></isNotNull>

			,
			<include refid="updateXtzd"/>				
		</dynamic>
		<![CDATA[ where ID = #id#]]>	
	</update>
	
	<!-- 注销 -->
	<update id="delete" parameterClass="zdryZdryzb">
		<![CDATA[ update ZDRY_ZDRYZB set ]]><include refid="deleteXtzd"/><![CDATA[ where ID = #id# ]]>	
	</update>
	
	
	<!-- 管理列表 -->
	<select id="queryCount" parameterClass="Map" resultClass="Integer">
		<![CDATA[ select count(*) from ZDRY_ZDRYZB z,RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b where 1=1 ]]>
		
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zdrygllxdm">
				z.zdrygllxdm = #zdryZdryzbVO.zdrygllxdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xm">
				r.xm like '%$zdryZdryzbVO.xm$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zjhm">
				r.zjhm = #zdryZdryzbVO.zjhm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xbdm">
				r.xbdm = #zdryZdryzbVO.xbdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.dz_jzdzxz">
				r.Jzd_dzxz like '%$zdryZdryzbVO.dz_jzdzxz$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.glbm">
				(z.glbm = #zdryZdryzbVO.glbm# or z.gxbm = #zdryZdryzbVO.glbm#)
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="zdryZdryzbVO.condition">
			     <![CDATA[ r.ZJHM || r.XM|| r.Jzd_dzxz   like '%' || #zdryZdryzbVO.condition# || '%']]>
			</isNotEmpty>

		<![CDATA[ and  (b.mldzid=r.Jzd_mlpdm or ((r.Hjd_mlpdm = b.mldzid and  r.Jzd_mlpdm is null))) and r.ID=z.RYID and z.glzt in (2,3,5,7)  and  z.XT_ZXBZ = '0' and b.xt_zxbz='0' ]]>
	</select>
	<select id="query" parameterClass="Map" resultClass="zdryZdryzbVO">
		<![CDATA[ select * from ( select rownum r ,m.*,L.BZ as zdrygllxmc from (
			select z.*,r.CYZJDM,r.ZJHM,r.XM,r.XBDM,r.MZDM,r.CSRQ,r.Jzd_dzxz as dz_jzdzxz,b.zbx , b.zby from ZDRY_ZDRYZB z,RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b where 1=1   ]]>
									
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zdrygllxdm">
				z.zdrygllxdm = #zdryZdryzbVO.zdrygllxdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xm">
				r.xm like '%$zdryZdryzbVO.xm$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zjhm">
				r.zjhm = #zdryZdryzbVO.zjhm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xbdm">
				r.xbdm = #zdryZdryzbVO.xbdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.dz_jzdzxz">
				r.Jzd_dzxz like '%$zdryZdryzbVO.dz_jzdzxz$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.glbm">
				(z.glbm = #zdryZdryzbVO.glbm# or z.gxbm = #zdryZdryzbVO.glbm#)
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="zdryZdryzbVO.condition">
			     <![CDATA[ r.ZJHM || r.XM|| r.Jzd_dzxz   like '%' || #zdryZdryzbVO.condition# || '%']]>
			</isNotEmpty>

			<![CDATA[ and  (b.mldzid=r.Jzd_mlpdm or ((r.Hjd_mlpdm = b.mldzid and  r.Jzd_mlpdm is null))) and r.ID=z.RYID and z.glzt in (2,3,5,7)  and  z.XT_ZXBZ = '0' and b.xt_zxbz='0' order by z.$sort$ $order$) m  left join  ZDRY_ZDRYLXYLBDYB L on (L.LBDM=m.ZDRYGLLXDM and L.QYDM=#QYDM#) where rownum <= #end# ) where r > #begin# ]]>
	</select>
	
	
	<!-- 重点人员地图查询 -->
	<select id="queryZdryOnPT" parameterClass="Map" resultClass="zdryZdryzbVO">
		<![CDATA[ select * from ( select rownum r ,m.* from (			
			
			select z.*,r.CYZJDM,r.ZJHM,r.XM,r.XBDM,r.MZDM,r.CSRQ,r.Jzd_dzxz as dz_jzdzxz,b.zbx , b.zby ,g.*,L.BZ as zdrygllxmc 
			from ZDRY_ZDRYZB z
        	left join  ZDRY_ZDRYLXYLBDYB L on (L.LBDM=z.ZDRYGLLXDM and L.QYDM='210000')
			left join  (
				    select g1.ORGCODE as sszrqdm ,g2.ORGCODE as sspcsdm,g3.ORGCODE as ssfxjdm from ORG_ORGANIZATION g1, ORG_ORGANIZATION g2, ORG_ORGANIZATION g3
				    where g2.id=g1.PARENTID
				    and g3.id=g2.PARENTID
				) g on (g.SSZRQDM = z.glbm)
			left join  (
				    select g1.ORGCODE as gxsszrqdm ,g2.ORGCODE as gxsspcsdm,g3.ORGCODE as gxssfxjdm from ORG_ORGANIZATION g1, ORG_ORGANIZATION g2, ORG_ORGANIZATION g3
				    where g2.id=g1.PARENTID
				    and g3.id=g2.PARENTID
				) gx on (gx.GXSSZRQDM = z.gxbm),
				RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b 
			where 1=1
			and  (b.mldzid=r.Jzd_mlpdm or ((r.Hjd_mlpdm = b.mldzid and  r.Jzd_mlpdm is null))) and r.ID=z.RYID 
			and  z.XT_ZXBZ = '0' and b.xt_zxbz='0'	
		
		]]>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.glzt">
				z.glzt = #zdryZdryzbVO.glzt#
			</isNotEmpty>
			<isEmpty prepend="and" property="zdryZdryzbVO.glzt">
				z.glzt != '4'
			</isEmpty>						
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zdrygllxdm">
				z.zdrygllxdm = #zdryZdryzbVO.zdrygllxdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xm">
				r.xm like '%$zdryZdryzbVO.xm$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zjhm">
				r.zjhm = #zdryZdryzbVO.zjhm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xbdm">
				r.xbdm = #zdryZdryzbVO.xbdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.dz_jzdzxz">
				r.Jzd_dzxz like '%$zdryZdryzbVO.dz_jzdzxz$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.glbm">
				z.glbm = #zdryZdryzbVO.glbm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.condition">
			     <![CDATA[( r.ZJHM || r.XM|| r.Jzd_dzxz   like '%' || #zdryZdryzbVO.condition# || '%' )]]>
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="zdryZdryzbVO.sszrqdm">
				(g.SSZRQDM = #zdryZdryzbVO.sszrqdm# or gx.GXSSZRQDM = #zdryZdryzbVO.sszrqdm#)
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.sspcsdm">
				(g.SSPCSDM = #zdryZdryzbVO.sspcsdm# or gx.GXSSPCSDM = #zdryZdryzbVO.sspcsdm#)
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.ssfxjdm">
				(g.SSFXJDM = #zdryZdryzbVO.ssfxjdm# or gx.GXSSFXJDM = #zdryZdryzbVO.ssfxjdm#)
			</isNotEmpty>
			
			<![CDATA[ 
				order by z.$sort$ $order$
				
				) m  				
				where rownum <= #end# 
			) where r > #begin# 
			]]>			
	</select>
	<select id="queryCountZdryOnPT" parameterClass="Map" resultClass="Integer">
		<![CDATA[ select count(*) from (
			select z.*,r.CYZJDM,r.ZJHM,r.XM,r.XBDM,r.MZDM,r.CSRQ,r.Jzd_dzxz as dz_jzdzxz,b.zbx , b.zby ,g.*,gx.*,L.BZ as zdrygllxmc 
			from ZDRY_ZDRYZB z
        	left join  ZDRY_ZDRYLXYLBDYB L on (L.LBDM=z.ZDRYGLLXDM and L.QYDM='210000')
			left join  (
				    select g1.ORGCODE as sszrqdm ,g2.ORGCODE as sspcsdm,g3.ORGCODE as ssfxjdm from ORG_ORGANIZATION g1, ORG_ORGANIZATION g2, ORG_ORGANIZATION g3
				    where g2.id=g1.PARENTID
				    and g3.id=g2.PARENTID
				) g on (g.SSZRQDM = z.glbm)
			left join  (
				    select g1.ORGCODE as gxsszrqdm ,g2.ORGCODE as gxsspcsdm,g3.ORGCODE as gxssfxjdm from ORG_ORGANIZATION g1, ORG_ORGANIZATION g2, ORG_ORGANIZATION g3
				    where g2.id=g1.PARENTID
				    and g3.id=g2.PARENTID
				) gx on (gx.GXSSZRQDM = z.gxbm),
				RY_RYJBXXB r,BZDZ_ADD_MLDZDXB b 
			where 1=1
			and  (b.mldzid=r.Jzd_mlpdm or ((r.Hjd_mlpdm = b.mldzid and  r.Jzd_mlpdm is null))) and r.ID=z.RYID 
			and  z.XT_ZXBZ = '0' and b.xt_zxbz='0'	
		
		]]>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.glzt">
				z.glzt = #zdryZdryzbVO.glzt#
			</isNotEmpty>
			<isEmpty prepend="and" property="zdryZdryzbVO.glzt">
				z.glzt != '4'
			</isEmpty>						
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zdrygllxdm">
				z.zdrygllxdm = #zdryZdryzbVO.zdrygllxdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xm">
				r.xm like '%$zdryZdryzbVO.xm$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.zjhm">
				r.zjhm = #zdryZdryzbVO.zjhm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.xbdm">
				r.xbdm = #zdryZdryzbVO.xbdm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.dz_jzdzxz">
				r.Jzd_dzxz like '%$zdryZdryzbVO.dz_jzdzxz$%'
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.glbm">
				z.glbm = #zdryZdryzbVO.glbm#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.condition">
			     <![CDATA[( r.ZJHM || r.XM|| r.Jzd_dzxz   like '%' || #zdryZdryzbVO.condition# || '%' )]]>
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="zdryZdryzbVO.sszrqdm">
				(g.SSZRQDM = #zdryZdryzbVO.sszrqdm# or gx.GXSSZRQDM = #zdryZdryzbVO.sszrqdm#)
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.sspcsdm">
				(g.SSPCSDM = #zdryZdryzbVO.sspcsdm# or gx.GXSSPCSDM = #zdryZdryzbVO.sspcsdm#)
			</isNotEmpty>
			<isNotEmpty prepend="and" property="zdryZdryzbVO.ssfxjdm">
				(g.SSFXJDM = #zdryZdryzbVO.ssfxjdm# or gx.GXSSFXJDM = #zdryZdryzbVO.ssfxjdm#)
			</isNotEmpty>
			
			<![CDATA[ 
				)
			]]>	
	</select>	
		
	
	
			<!-- 获取空间图层srid -->
	<select id="queryShapetableSrid" parameterClass="map" resultClass="int">
				select srid from sde.st_geometry_columns t where t.table_name=UPPER(#tableName#) and owner=UPPER(#shapeDbName#)
	</select>	
	
	<select id="queryBySyrkidAndgllx" parameterClass="Map" resultClass="zdryZdryzb">
		<![CDATA[ select * from ZDRY_ZDRYZB t where syrkid = #syrkid#  and zdrygllxdm = #gllx# and XT_ZXBZ = '0' and rownum = 1    ]]>
	</select>
	
	
		<!-- 根据查询可以注销的实有人口 是不是重口 -->
	<select id="queryCountBySyrk" parameterClass="String" resultClass="Integer">
		<![CDATA[ select count(1) from ZDRY_ZDRYZB t where t.XT_ZXBZ = '0' and t.SYRKID = #syrkId# and t.GLZT  in (2,3,5,7)]]>
		
	</select>
	
	<!-- 根据门楼牌查询户籍地责任区代码 -->
	<select id="queryHjdZrqdm" parameterClass="String" resultClass="String">
		<![CDATA[ select ZRQDM from BZDZ_ADD_MLDZDXB where MLDZID=#MLDZID#]]>
		
	</select>
</sqlMap>